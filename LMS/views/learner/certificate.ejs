<%- include("../partials/header") %>

<div class="text-center mt-4">
    <button id="download-btn" class="bg-red-600 text-white px-8 py-3 rounded-lg text-lg font-semibold hover:bg-red-700 shadow-xl transition duration-300">
        ⬇️ Download Certificate (PDF)
    </button>
</div>

<div id="certificate-content" class="bg-white p-12 shadow-2xl rounded-xl text-center mx-auto max-w-4xl border-[16px] border-double border-indigo-700 mt-5 mb-10" style="padding: 6rem 4rem;">
    <p class="text-2xl text-gray-500 italic mb-2">Mastery Learning Management System</p>
    <h1 class="text-6xl cert-title font-bold text-indigo-800 mb-6">Certificate of Achievement</h1>
    
    <p class="text-xl text-gray-600 mt-6">This certifies that</p>
    <h2 class="text-5xl font-extrabold my-6 border-b-4 border-yellow-500 inline-block px-8 pb-1 text-gray-900"><%= user.name %></h2>
    <p class="text-xl text-gray-600">Has successfully completed all requirements and passed the final assessment for the course</p>
    <h3 class="text-3xl font-bold text-green-700 my-4">"<%= course.title %>"</h3>
    
    <% if (score) { %>
        <div class="mt-6">
            <span class="bg-blue-100 text-blue-800 text-2xl font-extrabold px-6 py-2 rounded-full shadow-md">Final Grade: <%= score %>%</span>
        </div>
    <% } %>

    <div class="mt-16 flex justify-between items-center text-sm text-gray-700 px-10 border-t pt-4">
        <div>
            <p class="font-bold">Date Issued:</p>
            <%= new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) %>
        </div>
        <div>
            <p class="font-bold">Certificate ID:</p>
            <%= id %>
        </div>
    </div>
</div>
<script>
    document.getElementById('download-btn').addEventListener('click', function() {
        // Prepare for print/PDF (hiding navigation and button)
        const nav = document.querySelector('nav');
        if(nav) nav.style.display = 'none';
        
        // Hide the download button itself
        this.style.display = 'none'; 
        
        document.title = "Certificate - <%= course.title %>";
        
        // Trigger the browser's print dialog
        window.print();

        // Restore the original view
        setTimeout(() => {
            if(nav) nav.style.display = 'flex';
            this.style.display = 'block';
            document.title = "Mastery LMS"; // Restore original title
        }, 500); 
    });
</script>

<%- include("../partials/footer") %>